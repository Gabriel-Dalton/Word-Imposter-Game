<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VAGUE | Word Imposter Game</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">

        <!-- ═══ Main Menu ═══ -->
        <section id="menu-screen" class="screen active" aria-label="Main menu">
            <h1>VAGUE</h1>
            <p class="subtitle">Word Game</p>

            <div class="menu-options">
                <button class="btn btn-primary" id="start-new-game" aria-label="Start a new local game">New Game</button>
                <button class="btn" id="multiplayer-btn" aria-label="Open multiplayer options">Multiplayer</button>
                <button class="btn" id="settings-btn" aria-label="Open settings">Settings</button>
            </div>
        </section>

        <!-- ═══ Game Setup ═══ -->
        <section id="setup-screen" class="screen" aria-label="Game setup">
            <h2>SETUP GAME</h2>

            <div class="input-group">
                <label for="player-input">Add Player</label>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" id="player-input" placeholder="Enter name..." autocomplete="off" aria-label="Player name">
                    <button class="btn btn-primary" id="add-player-btn" style="padding: 0.5rem 1rem;" aria-label="Add player">+</button>
                </div>
            </div>

            <div class="player-list" id="player-list" role="list" aria-label="Player list">
                <!-- Players will be added here -->
            </div>

            <div class="input-group">
                <label for="category-select">Category</label>
                <select id="category-select" aria-label="Word category">
                    <option value="household">Household Items</option>
                    <option value="movies">Movies</option>
                    <option value="celebrities">Celebrities</option>
                    <option value="anime">Anime</option>
                    <option value="food">Food &amp; Drink</option>
                </select>
            </div>

            <button class="btn btn-primary" id="begin-game-btn" style="margin-top: auto;" aria-label="Begin the game">Begin Mission</button>
            <button class="btn btn-secondary back-to-menu" style="margin-top: 1rem;" aria-label="Back to main menu">Back</button>
        </section>

        <!-- ═══ Reveal Sequence (Pass & Play) ═══ -->
        <section id="reveal-screen" class="screen" aria-label="Role reveal">
            <h2 id="round-display">IDENTITY CHECK</h2>

            <div class="reveal-content">
                <div class="player-name-display" id="current-player-name" aria-live="polite">PLAYER 1</div>

                <div class="role-reveal-box" id="reveal-box" role="button" tabindex="0" aria-label="Tap or press to reveal your role">
                    <div id="tap-instruction" class="tap-to-reveal">TAP TO REVEAL ROLE</div>
                    <div id="role-info" style="display: none;" aria-live="assertive">
                        <p class="reveal-text" id="role-type">YOU ARE A CIVILIAN</p>
                        <p class="hidden-word" id="secret-word">PAN</p>
                        <p class="hint-text" id="imposter-hint" style="display: none;">HINT: FRY</p>
                    </div>
                </div>

                <button class="btn btn-primary" id="next-player-btn" style="display: none; width: 100%;" aria-label="Pass to next player">Next Player</button>
            </div>
        </section>

        <!-- ═══ Discussion / Action Screen ═══ -->
        <section id="discussion-screen" class="screen" aria-label="Discussion phase">
            <h2 id="phase-title">CLUE PHASE</h2>

            <div class="reveal-content">
                <p id="discussion-instruction"
                    style="font-size: 1.5rem; color: var(--accent); margin-bottom: 1rem; font-weight: 700; text-transform: uppercase;"
                    aria-live="polite">
                    PLAYER NAME</p>
                <p id="phase-subtitle" style="color: var(--text-dim); margin-bottom: 2rem;">IS GIVING A CLUE...</p>

                <!-- Timer Component -->
                <div class="timer-container" aria-label="Game timer">
                    <div id="timer-display" class="timer-display" aria-live="off">00:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn" id="timer-toggle-btn" aria-label="Start or pause timer">START</button>
                        <button class="timer-btn" id="timer-reset-btn" aria-label="Reset timer">RESET</button>
                    </div>
                </div>

                <div class="discussion-actions"
                    style="width: 100%; display: flex; flex-direction: column; gap: 1rem; margin-top: 2rem;">
                    <button class="btn btn-primary" id="clue-next-btn" style="width: 100%;" aria-label="Next player's turn for clue">Next Player</button>

                    <div id="post-discussion-options"
                        style="display: none; flex-direction: column; gap: 1rem; width: 100%;">
                        <button class="btn btn-secondary" id="next-round-btn" aria-label="Start next round with same word">Next Round (Same Word)</button>
                        <button class="btn btn-primary" id="finish-mission-btn" aria-label="End the mission">Finish Mission</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ═══ Game Over / Results ═══ -->
        <section id="results-screen" class="screen" aria-label="Game results">
            <h1 style="font-size: 2.5rem;">MISSION OVER</h1>
            <div class="reveal-content">
                <p id="final-results-text" style="margin-bottom: 2rem;">Mission Complete.</p>
                <button class="btn btn-primary" id="restart-game-btn" style="width: 100%;" aria-label="Play again with same players">Play Again</button>
                <button class="btn btn-secondary back-to-menu" style="margin-top: 1rem; width: 100%;" aria-label="Return to main menu">Main Menu</button>
            </div>
        </section>

        <!-- ═══ Multiplayer Menu ═══ -->
        <section id="multiplayer-screen" class="screen" aria-label="Multiplayer options">
            <h2>MULTIPLAYER</h2>

            <div class="menu-options" style="margin-top: 2rem;">
                <button class="btn btn-primary" id="local-mp-btn" aria-label="Start local pass-and-play game">Local (Pass &amp; Play)</button>
                <button class="btn btn-primary" id="host-game-btn" aria-label="Host an online game">Host Online Game</button>
                <button class="btn" id="join-game-btn" aria-label="Join an online game">Join Online Game</button>
                <button class="btn btn-secondary back-to-menu" style="margin-top: 1rem;" aria-label="Back to main menu">Back</button>
            </div>

            <p class="mp-help-text">
                <strong>Local:</strong> Pass the device between players.<br>
                <strong>Online:</strong> Each player on their own device — no server needed.
            </p>
        </section>

        <!-- ═══ Host Lobby ═══ -->
        <section id="host-lobby-screen" class="screen" aria-label="Host game lobby">
            <h2>HOST GAME</h2>

            <div class="lobby-scroll">
                <div class="input-group">
                    <label for="host-name-input">Your Name</label>
                    <input type="text" id="host-name-input" placeholder="Enter your name..." autocomplete="off">
                </div>

                <div class="input-group">
                    <label for="host-category-select">Category</label>
                    <select id="host-category-select">
                        <option value="household">Household Items</option>
                        <option value="movies">Movies</option>
                        <option value="celebrities">Celebrities</option>
                        <option value="anime">Anime</option>
                        <option value="food">Food &amp; Drink</option>
                    </select>
                </div>

                <button class="btn btn-primary" id="generate-offer-btn" style="width: 100%; margin-bottom: 1rem;" aria-label="Generate invite code">Generate Invite Code</button>

                <div class="input-group" id="offer-section" style="display: none;">
                    <label>Step 1 — Share this invite code</label>
                    <textarea id="offer-code-area" readonly rows="3" aria-label="Invite code to share"></textarea>
                    <button class="btn" id="copy-offer-btn" style="margin-top: 0.5rem; width: 100%;">Copy Invite Code</button>
                </div>

                <div class="input-group" id="answer-section" style="display: none;">
                    <label for="answer-paste-area">Step 2 — Paste their response code</label>
                    <textarea id="answer-paste-area" rows="3" placeholder="Paste response code here..." aria-label="Paste peer response code"></textarea>
                    <button class="btn btn-primary" id="accept-answer-btn" style="margin-top: 0.5rem; width: 100%;">Connect Player</button>
                </div>

                <p id="host-status" class="status-text" aria-live="polite">Enter your name and generate an invite code.</p>

                <div class="player-list" id="host-player-list" role="list" aria-label="Connected players">
                    <!-- Connected players appear here -->
                </div>
            </div>

            <button class="btn btn-primary" id="host-start-btn" style="margin-top: auto; width: 100%;" disabled aria-label="Start the game">Start Game (need 3+ players)</button>
            <button class="btn btn-secondary back-to-menu" style="margin-top: 0.5rem;" aria-label="Back to multiplayer menu">Back</button>
        </section>

        <!-- ═══ Join Lobby ═══ -->
        <section id="join-lobby-screen" class="screen" aria-label="Join game lobby">
            <h2>JOIN GAME</h2>

            <div class="lobby-scroll">
                <div class="input-group">
                    <label for="join-name-input">Your Name</label>
                    <input type="text" id="join-name-input" placeholder="Enter your name..." autocomplete="off">
                </div>

                <div class="input-group">
                    <label for="offer-paste-area">Step 1 — Paste the host's invite code</label>
                    <textarea id="offer-paste-area" rows="3" placeholder="Paste invite code here..." aria-label="Paste host invite code"></textarea>
                </div>

                <button class="btn btn-primary" id="generate-answer-btn" style="width: 100%; margin-bottom: 1rem;" aria-label="Generate response code">Join Game</button>

                <div class="input-group" id="answer-out-section" style="display: none;">
                    <label>Step 2 — Share this response code with the host</label>
                    <textarea id="answer-code-area" readonly rows="3" aria-label="Your response code to share with host"></textarea>
                    <button class="btn" id="copy-answer-btn" style="margin-top: 0.5rem; width: 100%;">Copy Response Code</button>
                </div>

                <p id="join-status" class="status-text" aria-live="polite">Enter your name and paste the host's invite code.</p>

                <div class="player-list" id="join-player-list" role="list" aria-label="Connected players">
                    <!-- Players synced from host -->
                </div>
            </div>

            <button class="btn btn-secondary back-to-menu" style="margin-top: auto;" aria-label="Back to multiplayer menu">Back</button>
        </section>

        <!-- ═══ Online Reveal (each player sees own role) ═══ -->
        <section id="online-reveal-screen" class="screen" aria-label="Your role reveal">
            <h2>YOUR ROLE</h2>

            <div class="reveal-content">
                <div class="player-name-display" id="online-player-name" aria-live="polite">YOUR NAME</div>

                <div class="role-reveal-box" id="online-reveal-box" role="button" tabindex="0" aria-label="Tap or press to reveal your role">
                    <div id="online-tap-instruction" class="tap-to-reveal">TAP TO REVEAL ROLE</div>
                    <div id="online-role-info" style="display: none;" aria-live="assertive">
                        <p class="reveal-text" id="online-role-type">YOU ARE A CIVILIAN</p>
                        <p class="hidden-word" id="online-secret-word">???</p>
                        <p class="hint-text" id="online-imposter-hint" style="display: none;">HINT: ???</p>
                    </div>
                </div>

                <button class="btn btn-primary" id="online-ready-btn" style="display: none; width: 100%;" aria-label="Signal that you are ready">I'm Ready</button>
            </div>
        </section>

        <!-- ═══ Settings ═══ -->
        <section id="settings-screen" class="screen" aria-label="Settings">
            <h2>SETTINGS</h2>

            <div class="reveal-content" style="justify-content: flex-start; margin-top: 2rem;">
                <p class="mp-help-text" style="text-align: center; margin-bottom: 2rem;">
                    Controls: <strong>Space / Enter</strong> to confirm,
                    <strong>Escape</strong> to go back.<br>
                    Gamepad supported (D-pad + A/B buttons).
                </p>

                <p class="mp-help-text" style="text-align: center;">
                    <strong>P1:</strong> WASD + Space<br>
                    <strong>P2:</strong> Arrow Keys + Enter
                </p>
            </div>

            <button class="btn btn-secondary back-to-menu" style="margin-top: auto;" aria-label="Back to main menu">Back</button>
        </section>

        <!-- ═══ Toast container ═══ -->
        <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

    </div>

    <script type="module" src="app.js"></script>
</body>

</html>
